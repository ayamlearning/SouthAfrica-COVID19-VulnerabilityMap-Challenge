import pickle
from sklearn import metrics
import numpy as np

class MyUtil:
    def __init__(self):
        self.modelfilename="project/models/regressormodel.sav"
        self.submissionfilename="project/submission/my_submission.csv"

    def load_model(self):
        model =pickle.load(open(self.modelfilename, 'rb'))
        return model

    def save_model(self,model):
        pickle.dump(model, open(self.modelfilename,'wb'))

    def save_csv(self,submission):
        submission.to_csv(self.submissionfilename,index=False)
        print('Saved file: ' + self.filename)

    def model_metrics(self,y_true,y_pred,len_training_size):
        print('R^2:',metrics.r2_score(y_true, y_pred))
        print('Adjusted R^2:',1 - (1-metrics.r2_score(y_true, y_pred))*(len(y_true)-1)/(len(y_true)-len_training_size-1))
        print('MAE:',metrics.mean_absolute_error(y_true, y_pred))
        print('MSE:',metrics.mean_squared_error(y_true, y_pred))
        print('RMSE:',np.sqrt(metrics.mean_squared_error(y_true, y_pred)))
